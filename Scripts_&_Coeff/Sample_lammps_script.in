
# set up the pressure
# Let f be the magnitude of the LAMMPS force variable using real units (kcal / Angstrom-mol).
variable p1 equal  0.01791576     # Force equivalent to 501 bar
variable p2 equal  -0.00003576  # Force equivalent to    1 bar

# System setup
atom_style  full
units   real
dimension 3
boundary p p p
neighbor        2.0 bin
neigh_modify	every 1 delay 0 check yes
timestep 1.0

#read_restart    piston_500_tmp.restart.30000000  
# Define interaction parameters
pair_style      hybrid lj/charmm/coul/long 9.0 12.0 12.0 tersoff
bond_style      hybrid harmonic                             
angle_style     hybrid harmonic                             
dihedral_style  hybrid harmonic opls                              
improper_style  none                                                                                     
kspace_style    pppm 1.0e-4                                                 
special_bonds   amber 

# Read/analyze init geometry
read_data      ETH75.data
include        System_ethanol_water_coeff.in


# Defining the groups	

group wall    type 12
group ethanol type 13 14 15 16 17 19
group water   type 18 20  
group polymer type 1 2 3 4 5 6 7 8 9 10 11
group          piston1   id 6791:7934
group          piston2   id 7935:9078
group bothpistons  union piston1 piston2
group solvents   union water ethanol
fix            fshake   water   shake 0.000001 2000 0 b 22 a 36



group fixmematoms id 4976	4980	4985	5862	4984	4982	4981	4979	5853	4130	4102	4975	4973	4113	1793	1807	1806	1800	1798	1799	1797	1794	1796	1805	1801	1804	1795	5863	5859	1815	1816	1817	3339	3342	3343	3352	3334	3333	3335	3332	3331	3326	3329	3327	3328	3360	3330	1792	1791	1789	1788	1820	1787	1790	1786	2152	6531	3184	3174	3183	6538	6542	6539	6540	3175	3176	6541	3177	3151	3152	3161	3182	3181	3169	3166	3180	3170	3165	3171	3162	3163	3179	3178	1881	1879	1888	1880	1889	3172	2153	2143	2155	2150	2148	2154	2149	2151	2147	2144	2146	2145	2156	2142	2159	2140	2141	2139	2162	2136	2160	2138	2137	2168	2169	2170	3173	6230	6200	6198	6197	6229	6199	6205	6201	6202	1281	1289	6196	6228	6222	6219	6220	6221	1288	1282	4977	4978	4988	4974	5867	5868	3155	3185	3153	5422	1819	1812	5421	1811	5420	1810	5419	5409	1818	5418	5410	1809	5411	5405	5412	3160	5413	3157	3154	3156	3158	3168	3159	3167	3164	4582	2053	2052	2031	2046	2038	2049	2051	2050	2041	2042	2044	2040	2039	2048	2043	2045	2057	2055	2036	6218	2063	6215	2056	6225	6214	6207	6223	6227	6217	2054	6208	6206	6224	6210	6211	6216	6226	6203	6209	6204	6212	5406	5403	5401	5400	5404	5394	5399	5402	5396	5408	5393	5398	5397	5417	5407	5391	2047	2037	2034	2033	2035	2032	2065	2064	723	722	728	5169	1081	1066	1080	1069	4856	4855	1324	1070	5178	5171	5170	4863	4854	1323	5172	1317	1316	1188	1159	1065	1078	1071	1160	1190	1158	1157	1189	1072	1156	3795	1073	3791	3793	3792	3796	1318	3789	3790	3800	3799	3794	5885	5904	5914	5913	5882	5905	5907	5881	5891	5883	5886	5890	5884	5887	4127	4501	5894	4503	5889	5897	5888	5898	4502	4495	4500	2164	2166	4331	2167	2165	6416	6429	6410	6438	6407	6408	6430	6406	6432	6409	6440	6439	6411	6412	6415	6413	6422	6431	2825	6437	2833		6434	6435	6421	6428	6433	6424	6426	6425	6427	6420	6418	6423	6414	6419	5177	3780	3750	2834	1062	1061	1055	1053	1054	1085	1056	1060	1327	1326	1325	1063	1057	1051	5162	5179	1315	5146	5150	5147	5180	1311	1306	1314	1307	1305	1308	1310	5148	5152	5149	5151	5163	5153	1301	5155	1304	1309	1313	5176	5154	5159	5156	5161	5160	5158	5157	5164	5165	5175	5166	5167	3751	3779	3746	3747	3769	3778	3772	5174	3770	5173	3771	5168	3748	3752	1059	1068	1187	1058	1064	1352	1067	1353	3803	3802	4997	1186	4996	3801	4971	4995	3808	4972	3810	3811	3812	1303	5003	3809	4994	1312	5004	5915	4496	4494	4493	4482	4489	4492	4490	4498	4483	4484	4487	4488	4486	4491	4497	4485	4481	4499	2059	2060	2061	2062	2058	6213	1362	1320	1360	1359	1361	1319	1328	1329	1297	1358	1322	1302	1299	1296	1300	1298	1330	1351	1321	4987	5005	4515	3381	3388	3382	3383	2796	1006	2797	6640	6648	6641	6639	2793	2794	6642	2786	2795	2787	5854	5855	5880	5848	5847	5879	5849	5850	5846	5872	5851	5852	5870	5878	5871	2770	2785	2784	2776	2781	2791	2777	2775	2790	2798	2792	2766	2771	2767	2799	1047	1803	1802	2768	2800	2769	1032	1033	1023	2772	1029	1030	1024	1028	1034	1035	1031	1027	1026	1025	1020	1019	1021	1022	1283	5141	5142	2157	2158	2788	5856	2778	2780	2774	2779	2773	2782	5857	5860	5858	5877	5861	5866	5865	5873	5864	5876	5875	5874	1041	1039	2783	1018	1016	1040	1048		1042	4565	4566	4569	4580	4581	5395	5425	4570	5415	4579	4573	5423	5414	4578	4571	4572	5424	5392	5416	5114	5116	5127	5118	3556	3563	2334	4322	1208	3570	3538	3539	3541	3537	3555	3546	3547	3545	3551	3536	3554	3548	3550	4323	2809	2807	2817	2818	2808	2810	2806	2827	2801	3761	3776	3764	3775	3765	3766	3773	3774	1207	3767	3559	3569	3568	1012	3141	3140	9	14	13	15	2804	11	12	16	19	30	31	32	2803	2805	2835	20	2802	3511	3501	3502	3535	3506	3503	3504	3505	3507	3510	3527	1182	1162	1172	1173	1163	1164	1161	1165	5128	5120	5119	3557	3558	5121	5124	5122	5123	5125	5126	5130	5129	5132	5133	5131	5140	5138	5139	4574	4330	4313	4332	4312	4338	4340	4306	4339	4311	4309	4308	4307	4310	4583	4315	4584	4316	2163	4329	3542	3553	3543	3552	3544	3562	3549	4314	4319	4318	4320	4327	4317	4321	4336	4324	4335	4333	4334	4325	4326	1354	4328	3757	3756	3760	3749	3758	3763	3762	3753	3755	3759	3754	3768	1011	1009	1010	999	995	1000	996	993	1008	3560	1001	3561	1003	1002	23	1337	1077	1084	1075	29	1363	1356	1076	21	1074	1355	22	28	1357	1339	1083	1052	1347	1338	4506	4507	4505	1015	4513	4514	1004	985	1013	983	992	994	1014	984	982	991	990	986	981	987	1007	989	988	1005	6623	6633	1169	1178	1348	1171	1167	1184	1174	1176	1177	1175	1170	1168	1183	1185	5869	6632	4576	4575	4567	4585	4562	4563	4577	4555	4553	4552	4554	4568	4556	4560	4557	4559	4558	4551	4564	4561	4337	1365	1334	1333	1350	1331	1364	1332	1335	1336	1340	1349	1342	1341	1346	1343	4504	997	998



group membrane_atoms     subtract all bothpistons solvents



group membrane1_free subtract membrane_atoms fixmematoms


# Defining group of atoms in Nose-Hoover thermostat
group thermostat_target union solvents membrane1_free piston1 piston2



# --------------balance the CPU load-----------------
balance 1.0 shift xyz 20 1.1
fix 21 all balance 100000 1.0 shift xyz 20 1.1 out tmp.balance

# -------------initialization-----------------
fix freezemem fixmematoms setforce 0.0 0.0 0.0
velocity fixmematoms set 0.0 0.0 0.0 units box

# ------------- Equilibration ----------------
fix pistonkeep bothpistons setforce 0.0 0.0 NULL



fix piston1thrust piston1 aveforce NULL NULL ${p1}
fix piston2thrust piston2 aveforce NULL NULL ${p2}

fix NVTequilib thermostat_target nvt temp 300 300 $(100.0*dt)

thermo_style custom step vol temp  enthalpy 
restart 1000000 piston_500_tmp.restart
dump 1 all custom 10000 Filt_et75_50ns.lammpstrj id mol type type q xu yu zu vx vy vz fx fy fz ix iy iz

log piston_500.log
thermo 1000
run     25000000
write_data 75et_25ns.data

